<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoCRM Pro v2</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --background-color: #f0f0f0;
            --text-color: #333;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .menu-icon {
            font-size: 24px;
            cursor: pointer;
        }

        .sidebar {
            position: fixed;
            left: -250px;
            top: 0;
            width: 250px;
            height: 100%;
            background-color: white;
            transition: 0.3s;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            z-index: 1001;
            overflow-y: auto;
            padding-top: 60px;
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar ul {
            list-style-type: none;
            padding: 0;
        }

        .sidebar ul li a {
            display: block;
            padding: 15px;
            color: var(--text-color);
            text-decoration: none;
            border-bottom: 1px solid #eee;
        }

        .main-content {
            padding: 20px;
            margin-top: 60px;
        }

        .logout-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }

        .card {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            text-align: left;
            padding: 8px;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: var(--primary-color);
            color: white;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                left: -100%;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <span class="menu-icon" onclick="toggleSidebar()">‚ò∞</span>
        <h1>AutoCRM Pro</h1>
    </div>

    <div class="sidebar" id="sidebar">
        <ul>
            <li><a href="#" onclick="showSection('dashboard')">üìä Dashboard</a></li>
            <li><a href="#" onclick="showSection('inventory')">üöó Inventario</a></li>
            <li><a href="#" onclick="showSection('clients')">üë• Clientes</a></li>
            <li><a href="#" onclick="showSection('sales')">üí∞ Ventas</a></li>
            <li><a href="#" onclick="showSection('services')">üîß Servicios</a></li>
            <li><a href="#" onclick="showSection('pipelines')">üìà Pipelines</a></li>
            <li><a href="#" onclick="showSection('employees')">üë®‚Äçüíº Empleados</a></li>
            <li><a href="#" onclick="showSection('tags')">üè∑Ô∏è Etiquetas</a></li>
        </ul>
        <button class="logout-btn" onclick="logout()">Cerrar Sesi√≥n</button>
    </div>

    <div class="main-content" id="main-content">
        <!-- El contenido principal se cargar√° aqu√≠ din√°micamente -->
    </div>

    <script>
        // Configuraci√≥n de Firebase
        const firebaseConfig = {
            // Reemplaza esto con tu configuraci√≥n real de Firebase
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Funci√≥n para alternar la visibilidad del sidebar
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
        }

        // Funci√≥n para mostrar diferentes secciones
        function showSection(section) {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `<h2>${section.charAt(0).toUpperCase() + section.slice(1)}</h2>`;
            
            switch(section) {
                case 'dashboard':
                    showDashboard();
                    break;
                case 'inventory':
                    showInventory();
                    break;
                case 'clients':
                    showClients();
                    break;
                case 'sales':
                    showSales();
                    break;
                case 'services':
                    showServices();
                    break;
                case 'pipelines':
                    showPipelines();
                    break;
                case 'employees':
                    showEmployees();
                    break;
                case 'tags':
                    showTags();
                    break;
            }

            toggleSidebar();
        }

        // Funci√≥n para mostrar el dashboard
        async function showDashboard() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML += `
                <div class="card">
                    <h3>Resumen de Ventas</h3>
                    <canvas id="salesChart"></canvas>
                </div>
                <div class="card">
                    <h3>Clientes Nuevos</h3>
                    <canvas id="clientsChart"></canvas>
                </div>
            `;

            try {
                const salesData = await getSalesData();
                const clientsData = await getClientsData();

                createChart('salesChart', 'Ventas Mensuales', salesData);
                createChart('clientsChart', 'Nuevos Clientes', clientsData);
            } catch (error) {
                console.error("Error al cargar datos del dashboard:", error);
                mainContent.innerHTML += `<p>Error al cargar los datos. Por favor, int√©ntelo de nuevo m√°s tarde.</p>`;
            }
        }

        // Funci√≥n para crear gr√°ficos
        function createChart(canvasId, label, data) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
                    datasets: [{
                        label: label,
                        data: data,
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Funci√≥n para mostrar el inventario
        async function showInventory() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML += `
                <div class="card">
                    <h3>Inventario de Veh√≠culos</h3>
                    <button class="btn" onclick="showAddVehicleForm()">Agregar Veh√≠culo</button>
                    <table id="inventoryTable">
                        <thead>
                            <tr>
                                <th>Marca</th>
                                <th>Modelo</th>
                                <th>A√±o</th>
                                <th>Precio</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            `;

            try {
                const inventory = await getInventoryData();
                const tableBody = document.querySelector('#inventoryTable tbody');
                inventory.forEach(car => {
                    const row = tableBody.insertRow();
                    row.innerHTML = `
                        <td>${car.brand}</td>
                        <td>${car.model}</td>
                        <td>${car.year}</td>
                        <td>$${car.price.toLocaleString()}</td>
                        <td>
                            <button onclick="editVehicle('${car.id}')">Editar</button>
                            <button onclick="deleteVehicle('${car.id}')">Eliminar</button>
                        </td>
                    `;
                });
            } catch (error) {
                console.error("Error al cargar el inventario:", error);
                mainContent.innerHTML += `<p>Error al cargar el inventario. Por favor, int√©ntelo de nuevo m√°s tarde.</p>`;
            }
        }

        // Funci√≥n para mostrar el formulario de agregar veh√≠culo
        function showAddVehicleForm() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Agregar Veh√≠culo</h3>
                    <form id="addVehicleForm">
                        <div class="form-group">
                            <label for="brand">Marca:</label>
                            <input type="text" id="brand" required>
                        </div>
                        <div class="form-group">
                            <label for="model">Modelo:</label>
                            <input type="text" id="model" required>
                        </div>
                        <div class="form-group">
                            <label for="year">A√±o:</label>
                            <input type="number" id="year" required>
                        </div>
                        <div class="form-group">
                            <label for="price">Precio:</label>
                            <input type="number" id="price" required>
                        </div>
                        <button type="submit" class="btn">Agregar Veh√≠culo</button>
                    </form>
                </div>
            `;

            document.getElementById('addVehicleForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const vehicleData = {
                    brand: document.getElementById('brand').value,
                    model: document.getElementById('model').value,
                    year: parseInt(document.getElementById('year').value),
                    price: parseFloat(document.getElementById('price').value)
                };
                try {
                    await addVehicle(vehicleData);
                    alert('Veh√≠culo agregado con √©xito');
                    showInventory();
                } catch (error) {
                    console.error("Error al agregar veh√≠culo:", error);
                    alert('Error al agregar veh√≠culo. Por favor, int√©ntelo de nuevo.');
                }
            });
        }

        // Funciones para obtener datos (simularemos la obtenci√≥n de datos)
        async function getSalesData() {
            // Simular obtenci√≥n de datos de ventas
            return [10000, 15000, 13000, 17000, 20000, 18000];
        }

        async function getClientsData() {
            // Simular obtenci√≥n de datos de clientes
            return [5, 7, 3, 8, 4, 6];
        }

        async function getInventoryData() {
            // Simular obtenci√≥n de datos de inventario
            return [
                { id: '1', brand: 'Toyota', model: 'Corolla', year: 2022, price: 25000 },
                { id: '2', brand: 'Honda', model: 'Civic', year: 2021, price: 23000 },
                { id: '3', brand: 'Ford', model: 'Mustang', year: 2023, price: 45000 }
            ];
        }

        // Funciones CRUD para veh√≠culos (simuladas)
        async function addVehicle(vehicleData) {
            // Simular agregar veh√≠culo a la base de datos
            console.log("Veh√≠culo agregado:", vehicleData);
        }

        async function editVehicle(id) {
            // Implementar l√≥gica para editar veh√≠culo
            console.log("Editando veh√≠culo con ID:", id);
        }

        async function deleteVehicle(id) {
            // Implementar l√≥gica para eliminar veh√≠culo
            console.log("Eliminando veh√≠culo con ID:", id);
        }

        // Funci√≥n para cerrar sesi√≥n
        function logout() {
            firebase.auth().signOut().then(() => {
                alert('Has cerrado sesi√≥n correctamente');
                // Redirigir a la p√°gina de inicio de sesi√≥n
                // window.location.href = 'login.html';
            }).catch((error) => {
                console.error('Error al cerrar sesi√≥n:', error);
            });
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', () => {
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    showDashboard();
                } else {
                    showLoginForm();
                }
            });
        });

        function showLoginForm() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h2>Iniciar Sesi√≥n</h2>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="email">Email:</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Contrase√±a:</label>
                            <input type="password" id="password" required>
                        </div>
                        <button type="submit" class="btn">Iniciar Sesi√≥n</button>
                    </form>
                </div>
            `;

            document.getElementById('loginForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                try {
                    await firebase.auth().signInWithEmailAndPassword(email, password);
                    showDashboard();
                } catch (error) {
                    console.error("Error de autenticaci√≥n:", error);
                    alert('Error al iniciar sesi√≥n. Verifique sus credenciales.');
                }
            });
        }

        async function showClients() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Clientes</h3>
                    <button class="btn" onclick="showAddClientForm()">Agregar Cliente</button>
                    <table id="clientsTable">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Tel√©fono</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            `;

            try {
                const clients = await getClientsData();
                const tableBody = document.querySelector('#clientsTable tbody');
                clients.forEach(client => {
                    const row = tableBody.insertRow();
                    row.innerHTML = `
                        <td>${client.name}</td>
                        <td>${client.email}</td>
                        <td>${client.phone}</td>
                        <td>
                            <button onclick="editClient('${client.id}')">Editar</button>
                            <button onclick="deleteClient('${client.id}')">Eliminar</button>
                        </td>
                    `;
                });
            } catch (error) {
                console.error("Error al cargar clientes:", error);
                mainContent.innerHTML += `<p>Error al cargar los clientes. Por favor, int√©ntelo de nuevo m√°s tarde.</p>`;
            }
        }

        function showAddClientForm() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Agregar Cliente</h3>
                    <form id="addClientForm">
                        <div class="form-group">
                            <label for="name">Nombre:</label>
                            <input type="text" id="name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email:</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Tel√©fono:</label>
                            <input type="tel" id="phone" required>
                        </div>
                        <button type="submit" class="btn">Agregar Cliente</button>
                    </form>
                </div>
            `;

            document.getElementById('addClientForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const clientData = {
                    name: document.getElementById('name').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value
                };
                try {
                    await addClient(clientData);
                    alert('Cliente agregado con √©xito');
                    showClients();
                } catch (error) {
                    console.error("Error al agregar cliente:", error);
                    alert('Error al agregar cliente. Por favor, int√©ntelo de nuevo.');
                }
            });
        }

        async function showSales() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Ventas</h3>
                    <button class="btn" onclick="showAddSaleForm()">Registrar Venta</button>
                    <table id="salesTable">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Cliente</th>
                                <th>Veh√≠culo</th>
                                <th>Monto</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            `;

            try {
                const sales = await getSalesData();
                const tableBody = document.querySelector('#salesTable tbody');
                sales.forEach(sale => {
                    const row = tableBody.insertRow();
                    row.innerHTML = `
                        <td>${new Date(sale.date).toLocaleDateString()}</td>
                        <td>${sale.clientName}</td>
                        <td>${sale.vehicleName}</td>
                        <td>$${sale.amount.toLocaleString()}</td>
                        <td>
                            <button onclick="editSale('${sale.id}')">Editar</button>
                            <button onclick="deleteSale('${sale.id}')">Eliminar</button>
                        </td>
                    `;
                });
            } catch (error) {
                console.error("Error al cargar ventas:", error);
                mainContent.innerHTML += `<p>Error al cargar las ventas. Por favor, int√©ntelo de nuevo m√°s tarde.</p>`;
            }
        }

        function showAddSaleForm() {
            // Implementar formulario para agregar venta
        }

        async function showServices() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Servicios</h3>
                    <button class="btn" onclick="showAddServiceForm()">Programar Servicio</button>
                    <table id="servicesTable">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Cliente</th>
                                <th>Veh√≠culo</th>
                                <th>Tipo de Servicio</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            `;

            try {
                const services = await getServicesData();
                const tableBody = document.querySelector('#servicesTable tbody');
                services.forEach(service => {
                    const row = tableBody.insertRow();
                    row.innerHTML = `
                        <td>${new Date(service.date).toLocaleDateString()}</td>
                        <td>${service.clientName}</td>
                        <td>${service.vehicleName}</td>
                        <td>${service.type}</td>
                        <td>${service.status}</td>
                        <td>
                            <button onclick="editService('${service.id}')">Editar</button>
                            <button onclick="deleteService('${service.id}')">Eliminar</button>
                        </td>
                    `;
                });
            } catch (error) {
                console.error("Error al cargar servicios:", error);
                mainContent.innerHTML += `<p>Error al cargar los servicios. Por favor, int√©ntelo de nuevo m√°s tarde.</p>`;
            }
        }

        function showAddServiceForm() {
            // Implementar formulario para agregar servicio
        }

        async function showPipelines() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Pipelines de Ventas</h3>
                    <div id="pipelinesContainer"></div>
                </div>
            `;

            try {
                const pipelines = await getPipelinesData();
                const pipelinesContainer = document.getElementById('pipelinesContainer');
                pipelines.forEach(pipeline => {
                    const pipelineElement = document.createElement('div');
                    pipelineElement.className = 'pipeline';
                    pipelineElement.innerHTML = `
                        <h4>${pipeline.name}</h4>
                        <div class="pipeline-stages">
                            ${pipeline.stages.map(stage => `
                                <div class="pipeline-stage">
                                    <h5>${stage.name}</h5>
                                    <ul>
                                        ${stage.opportunities.map(opp => `
                                            <li>${opp.name} - $${opp.value}</li>
                                        `).join('')}
                                    </ul>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    pipelinesContainer.appendChild(pipelineElement);
                });
            } catch (error) {
                console.error("Error al cargar pipelines:", error);
                mainContent.innerHTML += `<p>Error al cargar los pipelines. Por favor, int√©ntelo de nuevo m√°s tarde.</p>`;
            }
        }

        async function showEmployees() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Empleados</h3>
                    <button class="btn" onclick="showAddEmployeeForm()">Agregar Empleado</button>
                    <table id="employeesTable">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Cargo</th>
                                <th>Email</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            `;

            try {
                const employees = await getEmployeesData();
                const tableBody = document.querySelector('#employeesTable tbody');
                employees.forEach(employee => {
                    const row = tableBody.insertRow();
                    row.innerHTML = `
                        <td>${employee.name}</td>
                        <td>${employee.position}</td>
                        <td>${employee.email}</td>
                        <td>
                            <button onclick="editEmployee('${employee.id}')">Editar</button>
                            <button onclick="deleteEmployee('${employee.id}')">Eliminar</button>
                        </td>
                    `;
                });
            } catch (error) {
                console.error("Error al cargar empleados:", error);
                mainContent.innerHTML += `<p>Error al cargar los empleados. Por favor, int√©ntelo de nuevo m√°s tarde.</p>`;
            }
        }

        function showAddEmployeeForm() {
            // Implementar formulario para agregar empleado
        }

        async function showTags() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Etiquetas</h3>
                    <button class="btn" onclick="showAddTagForm()">Agregar Etiqueta</button>
                    <div id="tagsContainer"></div>
                </div>
            `;

            try {
                const tags = await getTagsData();
                const tagsContainer = document.getElementById('tagsContainer');
                tags.forEach(tag => {
                    const tagElement = document.createElement('span');
                    tagElement.className = 'tag';
                    tagElement.style.backgroundColor = tag.color;
                    tagElement.textContent = tag.name;
                    tagsContainer.appendChild(tagElement);
                });
            } catch (error) {
                console.error("Error al cargar etiquetas:", error);
                mainContent.innerHTML += `<p>Error al cargar las etiquetas. Por favor, int√©ntelo de nuevo m√°s tarde.</p>`;
            }
        }

        function showAddTagForm() {
            // Implementar formulario para agregar etiqueta
        }

        // Funciones simuladas para obtener datos
        async function getClientsData() {
            // Simular obtenci√≥n de datos de clientes desde Firebase
            return [
                { id: '1', name: 'Juan P√©rez', email: 'juan@example.com', phone: '123-456-7890' },
                { id: '2', name: 'Mar√≠a Garc√≠a', email: 'maria@example.com', phone: '098-765-4321' }
            ];
        }

        async function getSalesData() {
            // Simular obtenci√≥n de datos de ventas desde Firebase
            return [
                { id: '1', date: '2023-01-15', clientName: 'Juan P√©rez', vehicleName: 'Toyota Corolla', amount: 25000 },
                { id: '2', date: '2023-02-20', clientName: 'Mar√≠a Garc√≠a', vehicleName: 'Honda Civic', amount: 23000 }
            ];
        }

        async function getServicesData() {
            // Simular obtenci√≥n de datos de servicios desde Firebase
            return [
                { id: '1', date: '2023-03-10', clientName: 'Juan P√©rez', vehicleName: 'Toyota Corolla', type: 'Mantenimiento', status: 'Completado' },
                { id: '2', date: '2023-04-05', clientName: 'Mar√≠a Garc√≠a', vehicleName: 'Honda Civic', type: 'Reparaci√≥n', status: 'En progreso' }
            ];
        }

        async function getPipelinesData() {
            // Simular obtenci√≥n de datos de pipelines desde Firebase
            return [
                {
                    name: 'Pipeline de Ventas',
                    stages: [
                        { name: 'Contacto Inicial', opportunities: [{ name: 'Opp 1', value: 10000 }] },
                        { name: 'Negociaci√≥n', opportunities: [{ name: 'Opp 2', value: 15000 }] },
                        { name: 'Cierre', opportunities: [] }
                    ]
                }
            ];
        }

        async function getEmployeesData() {
            // Simular obtenci√≥n de datos de empleados desde Firebase
            return [
                { id: '1', name: 'Carlos Rodr√≠guez', position: 'Vendedor', email: 'carlos@example.com' },
                { id: '2', name: 'Ana Mart√≠nez', position: 'Gerente de Ventas', email: 'ana@example.com' }
            ];
        }

        async function getTagsData() {
            // Simular obtenci√≥n de datos de etiquetas desde Firebase
            return [
                { id: '1', name: 'VIP', color: '#FFD700' },
                { id: '2', name: 'Nuevo Cliente', color: '#90EE90' }
            ];
        }

        // Funciones CRUD simuladas
        async function addClient(clientData) {
            // Simular agregar cliente a Firebase
            console.log("Cliente agregado:", clientData);
        }
        // Funciones CRUD simuladas (continuaci√≥n)
        async function editClient(id) {
            try {
                const client = await getClientById(id);
                showEditClientForm(client);
            } catch (error) {
                console.error("Error al obtener datos del cliente:", error);
                alert('Error al cargar los datos del cliente. Por favor, int√©ntelo de nuevo.');
            }
        }

        async function deleteClient(id) {
            if (confirm('¬øEst√° seguro de que desea eliminar este cliente?')) {
                try {
                    await deleteClientFromDB(id);
                    alert('Cliente eliminado con √©xito');
                    showClients();
                } catch (error) {
                    console.error("Error al eliminar cliente:", error);
                    alert('Error al eliminar el cliente. Por favor, int√©ntelo de nuevo.');
                }
            }
        }

        function showEditClientForm(client) {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Editar Cliente</h3>
                    <form id="editClientForm">
                        <input type="hidden" id="clientId" value="${client.id}">
                        <div class="form-group">
                            <label for="name">Nombre:</label>
                            <input type="text" id="name" value="${client.name}" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email:</label>
                            <input type="email" id="email" value="${client.email}" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Tel√©fono:</label>
                            <input type="tel" id="phone" value="${client.phone}" required>
                        </div>
                        <button type="submit" class="btn">Actualizar Cliente</button>
                    </form>
                </div>
            `;

            document.getElementById('editClientForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const updatedClientData = {
                    id: document.getElementById('clientId').value,
                    name: document.getElementById('name').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value
                };
                try {
                    await updateClient(updatedClientData);
                    alert('Cliente actualizado con √©xito');
                    showClients();
                } catch (error) {
                    console.error("Error al actualizar cliente:", error);
                    alert('Error al actualizar el cliente. Por favor, int√©ntelo de nuevo.');
                }
            });
        }

        async function addSale(saleData) {
            try {
                await addSaleToDB(saleData);
                alert('Venta registrada con √©xito');
                showSales();
            } catch (error) {
                console.error("Error al registrar venta:", error);
                alert('Error al registrar la venta. Por favor, int√©ntelo de nuevo.');
            }
        }

        function showAddSaleForm() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Registrar Nueva Venta</h3>
                    <form id="addSaleForm">
                        <div class="form-group">
                            <label for="clientId">Cliente:</label>
                            <select id="clientId" required>
                                <option value="">Seleccione un cliente</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="vehicleId">Veh√≠culo:</label>
                            <select id="vehicleId" required>
                                <option value="">Seleccione un veh√≠culo</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="amount">Monto:</label>
                            <input type="number" id="amount" required min="0" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="date">Fecha:</label>
                            <input type="date" id="date" required>
                        </div>
                        <button type="submit" class="btn">Registrar Venta</button>
                    </form>
                </div>
            `;

            // Cargar clientes y veh√≠culos en los selectores
            loadClientsIntoSelect();
            loadVehiclesIntoSelect();

            document.getElementById('addSaleForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const saleData = {
                    clientId: document.getElementById('clientId').value,
                    vehicleId: document.getElementById('vehicleId').value,
                    amount: parseFloat(document.getElementById('amount').value),
                    date: document.getElementById('date').value
                };
                await addSale(saleData);
            });
        }

        async function loadClientsIntoSelect() {
            try {
                const clients = await getClientsData();
                const select = document.getElementById('clientId');
                clients.forEach(client => {
                    const option = document.createElement('option');
                    option.value = client.id;
                    option.textContent = client.name;
                    select.appendChild(option);
                });
            } catch (error) {
                console.error("Error al cargar clientes:", error);
                alert('Error al cargar la lista de clientes. Por favor, recargue la p√°gina.');
            }
        }

        async function loadVehiclesIntoSelect() {
            try {
                const vehicles = await getInventoryData();
                const select = document.getElementById('vehicleId');
                vehicles.forEach(vehicle => {
                    const option = document.createElement('option');
                    option.value = vehicle.id;
                    option.textContent = `${vehicle.brand} ${vehicle.model} (${vehicle.year})`;
                    select.appendChild(option);
                });
            } catch (error) {
                console.error("Error al cargar veh√≠culos:", error);
                alert('Error al cargar la lista de veh√≠culos. Por favor, recargue la p√°gina.');
            }
        }

        async function addService(serviceData) {
            try {
                await addServiceToDB(serviceData);
                alert('Servicio programado con √©xito');
                showServices();
            } catch (error) {
                console.error("Error al programar servicio:", error);
                alert('Error al programar el servicio. Por favor, int√©ntelo de nuevo.');
            }
        }

        function showAddServiceForm() {
            const mainContent = document.getElementById('main-content');
            mainContent.innerHTML = `
                <div class="card">
                    <h3>Programar Nuevo Servicio</h3>
                    <form id="addServiceForm">
                        <div class="form-group">
                            <label for="clientId">Cliente:</label>
                            <select id="clientId" required>
                                <option value="">Seleccione un cliente</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="vehicleId">Veh√≠culo:</label>
                            <select id="vehicleId" required>
                                <option value="">Seleccione un veh√≠culo</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="serviceType">Tipo de Servicio:</label>
                            <input type="text" id="serviceType" required>
                        </div>
                        <div class="form-group">
                            <label for="date">Fecha:</label>
                            <input type="date" id="date" required>
                        </div>
                        <div class="form-group">
                            <label for="status">Estado:</label>
                            <select id="status" required>
                                <option value="Programado">Programado</option>
                                <option value="En Progreso">En Progreso</option>
                                <option value="Completado">Completado</option>
                            </select>
                        </div>
                        <button type="submit" class="btn">Programar Servicio</button>
                    </form>
                </div>
            `;

            // Cargar clientes y veh√≠culos en los selectores
            loadClientsIntoSelect();
            loadVehiclesIntoSelect();

            document.getElementById('addServiceForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const serviceData = {
                    clientId: document.getElementById('clientId').value,
                    vehicleId: document.getElementById('vehicleId').value,
                    serviceType: document.getElementById('serviceType').value,
                    date: document.getElementById('date').value,
                    status: document.getElementById('status').value
                };
                await addService(serviceData);
            });
        }

        // Funciones simuladas de interacci√≥n con la base de datos
        async function getClientById(id) {
            // Simular obtenci√≥n de cliente por ID desde Firebase
            return { id: id, name: 'Cliente Ejemplo', email: 'ejemplo@email.com', phone: '123-456-7890' };
        }

        async function deleteClientFromDB(id) {
            // Simular eliminaci√≥n de cliente en Firebase
            console.log(`Cliente con ID ${id} eliminado`);
        }

        async function updateClient(clientData) {
            // Simular actualizaci√≥n de cliente en Firebase
            console.log('Cliente actualizado:', clientData);
        }

        async function addSaleToDB(saleData) {
            // Simular agregar venta a Firebase
            console.log('Venta registrada:', saleData);
        }

        async function addServiceToDB(serviceData) {
            // Simular agregar servicio a Firebase
            console.log('Servicio programado:', serviceData);
        }

        // Inicializaci√≥n y manejo de errores globales
        window.onerror = function(message, source, lineno, colno, error) {
            console.error("Error no capturado:", error);
            alert("Ha ocurrido un error inesperado. Por favor, recargue la p√°gina e int√©ntelo de nuevo.");
            return true;
        };

        // Asegurar que Firebase est√© inicializado antes de usar sus servicios
        if (!firebase.apps.length) {
            try {
                firebase.initializeApp(firebaseConfig);
            } catch (error) {
                console.error("Error al inicializar Firebase:", error);
                alert("Error al inicializar la aplicaci√≥n. Por favor, recargue la p√°gina.");
            }
        }

        // Iniciar la aplicaci√≥n
        document.addEventListener('DOMContentLoaded', () => {
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    showDashboard();
                } else {
                    showLoginForm();
                }
            });
        });
    </script>
</body>
</html>
